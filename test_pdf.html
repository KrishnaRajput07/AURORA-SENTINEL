<!DOCTYPE html>
<html>
<head>
    <title>PDF Generation Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <h1>AURORA-SENTINEL PDF Test</h1>
    <button onclick="generateTestPDF()">Generate Test PDF</button>
    <div id="status"></div>

    <script>
        function generateTestPDF() {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Header
                doc.setFontSize(22);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(33, 150, 243);
                doc.text('AURORA-SENTINEL', 20, 20);
                
                doc.setFontSize(16);
                doc.setTextColor(0, 0, 0);
                doc.text('Forensic Intelligence Report', 20, 30);
                
                // Test data
                const testAlerts = [
                    { timestamp_seconds: 5.2, level: 'high', score: 75, top_factors: ['Aggressive Posture: 80%', 'Proximity: 60%'] },
                    { timestamp_seconds: 12.8, level: 'medium', score: 45, top_factors: ['Loitering: 50%'] }
                ];
                
                const tableData = testAlerts.map(alert => [
                    `${Math.floor(alert.timestamp_seconds / 60)}:${(alert.timestamp_seconds % 60).toFixed(0).padStart(2, '0')}`,
                    alert.level.toUpperCase(),
                    `${alert.score}%`,
                    alert.top_factors.join(', ')
                ]);
                
                doc.autoTable({
                    head: [['Time', 'Risk Level', 'Score', 'Contributing Factors']],
                    body: tableData,
                    startY: 50,
                    theme: 'grid',
                    headStyles: { fillColor: [33, 150, 243], fontStyle: 'bold' }
                });
                
                // Save
                doc.save('AURORA-Test-Report.pdf');
                document.getElementById('status').innerHTML = '<p style="color: green;">✅ PDF Generated Successfully!</p>';
            } catch (error) {
                document.getElementById('status').innerHTML = '<p style="color: red;">❌ Error: ' + error.message + '</p>';
                console.error('PDF Error:', error);
            }
        }
    </script>
</body>
</html>
